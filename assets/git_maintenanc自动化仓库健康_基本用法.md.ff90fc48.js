import{_ as s,c as n,o as a,a as l}from"./app.5b8334ac.js";const d=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"git/maintenanc自动化仓库健康/基本用法.md","lastUpdated":1737081387000}'),p={name:"git/maintenanc自动化仓库健康/基本用法.md"},e=l(`<p><code>git maintenance</code>是在 Git 2.30.0 版本中引入的，用于管理和自动化各种维护任务的命令。这个命令旨在简化和优化仓库的维护工作，通过提供一组预定义的任务来帮助保持仓库的健康状态和高效性能。</p><ul><li><strong><code>git maintenance</code> 提供了几种子命令来管理不同的维护任务：</strong></li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dark-plus" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;"># </span><span style="color:#9CDCFE;">启用自动维护</span></span>
<span class="line"><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">start</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;"># </span><span style="color:#9CDCFE;">禁用自动维护</span></span>
<span class="line"><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">stop</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>执行一次性维护任务:</strong> 手动触发一次性的维护任务，这对于在特定时间点（如大型提交之后）优化仓库非常有用。</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dark-plus" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;"># </span><span style="color:#9CDCFE;">执行所有配置的维护任务</span></span>
<span class="line"><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">run</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;"># </span><span style="color:#9CDCFE;">执行特定类型的维护任务</span></span>
<span class="line"><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">run</span><span style="color:#D4D4D4;"> --</span><span style="color:#9CDCFE;">task</span><span style="color:#D4D4D4;">=</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">task</span><span style="color:#808080;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>常见的维护任务包括：</p><ul><li>gc：运行完整的垃圾收集，包括压缩对象数据库。commit-graph：构建或更新提交图文件以加速提交历史查询。</li><li>loose-objects：清理松散对象并将其打包。</li><li>incremental-repack：逐步重新打包对象以优化存储。</li><li>prefetch：预先获取远程分支的新数据，以加速未来的克隆和拉取操作。</li></ul></blockquote><ul><li><strong>配置自动维护计划:</strong> 可以通过配置文件设置哪些任务应该被定期执行以及它们的执行频率。例如，在 <code>.git/config</code> 文件中添加如下内容：</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dark-plus" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;daily&quot;</span><span style="color:#D4D4D4;">]</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">task</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">prefetch</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">task</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">loose</span><span style="color:#D4D4D4;">-</span><span style="color:#9CDCFE;">objects</span></span>
<span class="line"><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;hourly&quot;</span><span style="color:#D4D4D4;">]</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">task</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">commit</span><span style="color:#D4D4D4;">-</span><span style="color:#9CDCFE;">graph</span></span>
<span class="line"><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;weekly&quot;</span><span style="color:#D4D4D4;">]</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">task</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">incremental</span><span style="color:#D4D4D4;">-</span><span style="color:#9CDCFE;">repack</span></span>
<span class="line"><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;monthly&quot;</span><span style="color:#D4D4D4;">]</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">task</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">gc</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>然后启用这些计划：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dark-plus" tabindex="0"><code><span class="line"><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">start</span><span style="color:#D4D4D4;"> --</span><span style="color:#9CDCFE;">schedule</span><span style="color:#D4D4D4;">=</span><span style="color:#9CDCFE;">daily</span></span>
<span class="line"><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">start</span><span style="color:#D4D4D4;"> --</span><span style="color:#9CDCFE;">schedule</span><span style="color:#D4D4D4;">=</span><span style="color:#9CDCFE;">hourly</span></span>
<span class="line"><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">start</span><span style="color:#D4D4D4;"> --</span><span style="color:#9CDCFE;">schedule</span><span style="color:#D4D4D4;">=</span><span style="color:#9CDCFE;">weekly</span></span>
<span class="line"><span style="color:#9CDCFE;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">maintenance</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">start</span><span style="color:#D4D4D4;"> --</span><span style="color:#9CDCFE;">schedule</span><span style="color:#D4D4D4;">=</span><span style="color:#9CDCFE;">monthly</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>`,10),o=[e];function c(t,r,D,i,y,C){return a(),n("div",null,o)}const b=s(p,[["render",c]]);export{d as __pageData,b as default};
